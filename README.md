# БОТ КАРТА СТРЕЛКА

![Стрелка](logo.png)

Проект представляет собой бота для ВКонтакте и Telegram, написанного на PHP с применением фреймворка Laravel.

Особенность проекта состоит в том, что для двух разных соцсетей - одна реализация. Основная логика работы прописана в BotService, а для работы с разными API предусмотрены две реализации интерфейса IBotApi.

Используются VK Callback API и Telegram Bot API.
## Запуск в Docker
1. В файле .env указать переменные: `VK_ACCESS_TOKEN` - access_token сообщества ВК с правами на сообщения, `VK_CONFIRMATION_CODE` - код подтверждения для события confirmation ВК, `VK_SECRET` - секретный ключ, который будет приходить с каждым событием из ВК, `TG_TOKEN` - токен, полученный в Telegram у BotFather, а также переменные для подключения к базе данных (с префиксом `DB_`)
2. Создать образ контейнера: `docker build -t strelkabot .`
3. Запустить контейнер (например, на порте 8080): `docker run -d --name strelka -p 8080:8000 strelkabot`
4. Пробросить порт, чтобы был доступ из Интернета (или, например, запустить туннель ngrok)
5. Настроить ботов:
   - В ВК: в настройках Callback API указать адрес `https://<ip>/strelkabot/vk`, придумать секретный ключ и поставить галочку на событиях типа "Входящее сообщение"
   - В TG: сделать GET-запрос на `https://api.telegram.org/bot<TG_TOKEN>/setWebhook?url=<url>`, где вместо TG_TOKEN указать токен бота, а вместо url - `https://<ip>/strelkabot/tg`
